import{u as C,c as S,r as n,j as e,g as E}from"./index-6LOgL6T7.js";function I(){const p=C(),h=S(),[o,f]=n.useState(""),[l,x]=n.useState(""),[i,j]=n.useState(""),[g,u]=n.useState(!1),[b,s]=n.useState(""),[c,N]=n.useState(""),m=function(){s("")},v=function(t){if(s(""),t.target.files&&t.target.files[0]){if(t.target.files[0].size>15e5){s("Image size must be under 1.5MB"),t.target.files=null;return}const a=new FileReader;a.readAsDataURL(t.target.files[0]),a.onloadend=async()=>{const r=a.result;typeof r=="string"&&N(r)}}},y=async function(t){if(t.preventDefault(),console.log("submit"),!p.loggedIn){s("Please login to create new post");return}const a=[];if(o.trim()==""||i.trim()==""){s("Fields must not be empty");return}if(l!=""&&l.split(",").forEach(w=>{a.push(w.trim())}),a.length>5){s("Too many tags");return}const r={title:o,content:i,tags:[...a],img:{url:c,public_id:""+Math.random()*10}};try{u(!0),await E(r),h({to:"/"})}catch(d){console.log("Error ==> ",d)}finally{u(!1),console.log("end")}};return e.jsx(e.Fragment,{children:g?e.jsxs("div",{className:"center margin-top-xl",children:[e.jsx("h2",{className:"center margin-top-xl",children:"Creating new post...."}),e.jsx("p",{className:"center margin-top-xl",children:"Free server is slow..."})]}):e.jsxs("div",{className:"main",children:[e.jsx("h2",{className:"center",children:"Create New Post"}),e.jsxs("form",{className:"new-post-form",onSubmit:y,children:[c!=""?e.jsx("img",{src:c||void 0,className:"image-upload"}):"",e.jsx("label",{htmlFor:"image",children:"Image (optional)"}),e.jsx("input",{id:"image",className:"image-upload-input",type:"file",onChange:v}),e.jsx("label",{htmlFor:"title",children:"Title"}),e.jsx("input",{id:"title",type:"text",value:o,onChange:function(t){f(t.target.value),m()}}),e.jsx("label",{htmlFor:"content",children:"Content"}),e.jsx("textarea",{id:"content",value:i,onChange:function(t){j(t.target.value),m()}}),e.jsx("label",{htmlFor:"tags",children:"Tags (optional)"}),e.jsx("input",{placeholder:"comma separated, maximum 5",id:"tags",type:"text",value:l,onChange:function(t){x(t.target.value),m()}}),e.jsx("button",{className:"button margin-top",disabled:g,children:"CREATE"}),e.jsx("p",{className:"error",children:b})]})]})})}export{I as component};
